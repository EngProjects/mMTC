\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}

\pgfsetlayers{background,foreground}

\begin{tikzpicture}[
  line width=1pt, font=\footnotesize, >=stealth', draw=black,
  device/.style={circle, inner sep = 0pt, minimum height = 5mm, minimum width=5mm, draw=black, fill=gray!40, line width=0.5pt},
    decodeddevice/.style={circle, inner sep = 0pt, minimum height = 5mm, minimum width=5mm, draw=black, fill=blue, line width=0.5pt},
  slot/.style={rectangle, inner sep=0pt, minimum size=1.5mm, fill=black},
  packet/.style={rectangle, minimum height=4mm, minimum width=14mm, draw=black, fill=gray!20, rounded corners, line width=0.5pt},
    decodedpacket/.style={rectangle, minimum height=4mm, minimum width=14mm, draw=black, pattern=north east lines, rounded corners, line width=0.5pt}
]

\begin{pgfonlayer}{background}
\draw [->,line width=1.25pt] (0,-0.05) -- (8.25,-0.05);
\draw[line width=1.25pt] (0.25,-0.175) -- (0.25,2.45);
\foreach \x in {1,...,4} {
  \draw (1.5*\x+0.25,-0.175) -- (1.5*\x+0.25,0.075);
  \draw[dotted,line width=1.25pt] (1.5*\x+0.25,0.075) -- (1.5*\x+0.25,2.25);
}
\draw[line width=1.25pt] (7.75,-0.175) -- (7.75,2.45);
\draw[dashed,line width=1.25pt] (0,2.05) -- (8,2.05);

\foreach \x in {1,...,5} {
  \node (t\x) at (1.5*\x-0.5,2.3) {slot~\x};
}
\end{pgfonlayer}

\begin{pgfonlayer}{foreground}
\node[packet, fill=blue!50] (p12) at (2.5,0.25) {$m_1$};

\node[packet] (p21) at (1.0,0.75) {$m_2$};
\node[packet] (p23) at (4.0,0.75) {$m_2$};
\node[packet, fill=red!30!blue!60] (p24) at (5.5,0.75) {$m_2$};

\node[packet, fill=red!60!blue!30] (p31) at (1.0,1.25) {$m_3$};
\node[packet] (p33) at (4.0,1.25) {$m_3$};
\node[packet] (p35) at (7.0,1.25) {$m_3$};

\node[packet] (p42) at (2.5,1.75) {$m_4$};
\node[packet, fill=red!50] (p43) at (4.0,1.75) {$m_4$};
\node[packet] (p45) at (7.0,1.75) {$m_4$};
\end{pgfonlayer}
\end{tikzpicture}
